
CREATE PROCEDURE [dbo].[SP_GET_STD_CONTRACT_CODE] @DEAL_TYPE INT, @DEAL_NUM INT
AS
		DECLARE @STD_DOG_CODE INT
		SET @STD_DOG_CODE = 0

		IF @DEAL_TYPE = 1
				SET @STD_DOG_CODE  = ( SELECT STD_DOG_CODE FROM RAZPREG  WITH(NOLOCK)  WHERE DEAL_NUM = @DEAL_NUM  )
		ELSE IF @DEAL_TYPE = 2
				SET @STD_DOG_CODE  = ( SELECT CND_CODEDEF  FROM DEPOSREG WITH(NOLOCK)  WHERE DEAL_NUM = @DEAL_NUM  )
		ELSE IF @DEAL_TYPE = 4
				SET @STD_DOG_CODE  = ( SELECT STD_DOG_CODE FROM WLOGREG  WITH(NOLOCK)  WHERE DEAL_NUM = @DEAL_NUM  )
		ELSE IF @DEAL_TYPE = 9
				SET @STD_DOG_CODE  = ( SELECT STD_DOG_CODE FROM SPECREG  WITH(NOLOCK)   WHERE DEAL_NUM = @DEAL_NUM )
		ELSE IF @DEAL_TYPE = 11
				SET @STD_DOG_CODE  = ( SELECT CODE_NM184   FROM KRDREG  WITH(NOLOCK)   WHERE DEAL_NUM = @DEAL_NUM )
		ELSE IF @DEAL_TYPE = 13
				SET @STD_DOG_CODE  = ( SELECT TYPE_CARDHOLDER   FROM CSC_CARDS  WITH(NOLOCK)   WHERE DEAL_NUMBER = @DEAL_NUM )
		ELSE IF @DEAL_TYPE = 18
				SET @STD_DOG_CODE  = ( SELECT CODE_NM452   FROM GARANTREG WITH(NOLOCK) WHERE DEAL_NUM = @DEAL_NUM )
		ELSE IF @DEAL_TYPE = 25
				SET @STD_DOG_CODE  = ( SELECT PROD_CODE	   FROM INCASO  WITH(NOLOCK)   WHERE DEAL_NUM = @DEAL_NUM )
		ELSE IF @DEAL_TYPE = 24
				SET @STD_DOG_CODE  = ( SELECT PROD_CODE    FROM AKRED   WITH(NOLOCK)   WHERE DEAL_NUM = @DEAL_NUM )
		ELSE IF @DEAL_TYPE = 31
				SET @STD_DOG_CODE  = ( SELECT MERCH_CONTRACT_NUM FROM UTILITY_PAYMENTS_CLIENT_CONTRACTS WITH(NOLOCK) WHERE DEAL_NUM = @DEAL_NUM )
	RETURN 	@STD_DOG_CODE
GO

